<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test d3chart.js</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@0.7.3/dist/leaflet.css" media="screen" title="leaflet">
    <script src="https://unpkg.com/leaflet@0.7.3/dist/leaflet.js" charset="utf-8"></script>
    <script src="dist/leaflet.d3chart.js" charset="utf-8"></script>
  </head>
  <body>
    <select id = "year" onchange="updateData()">
      <option value="2015">2015</option>
      <option value="2012">2012</option>
      <option value="2009">2009</option>
      <option value="2006">2006</option>
    </select>
    <div id="map" style="width:1000px;height:800px;"></div>
    <script type="text/javascript">

var coord = [48.861415, 2.349326];

var mymap = L.map('map').setView(coord, 13);
var tiles = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
tiles.addTo(mymap);

// Let generate some random data
function fakeData(n) {
  var res = [];
  for (var i = 0; i < n; i++) {
    res.push([Math.random() * 2000]);
  }
  return res
}

// Create a barchart
var myBarChart = L.d3chart(coord, {
  data: fakeData(3),
  maxValues: 2000,
  type: "bar",
  labels: "auto",
  colors: ["white", "black", "blue"],
  width: 100
});
mymap.addLayer(myBarChart);

var myPieChart = L.d3chart([coord[0] - 0.01, coord[1]], {
  data: fakeData(3),
  maxValues: 2000,
  type: "pie",
  labels: "auto",
  colors: ["white", "black", "blue"],
  width: 100
});
mymap.addLayer(myPieChart);

//Update data every 2 seconds
setInterval(function() {
  myBarChart.setOptions({data: fakeData(3)});
  myPieChart.setOptions({data: fakeData(3)});
}, 2000);

/* Create a pie
var mypie = L.d3chart([coord[0], coord[1] + 0.02], {
  data:[1],
  maxValues: 3,
  type: "polar-area",
  colors:["red", "green", "orange", "blue"],
  showLabels:true
 })
mymap.addLayer(mypie);

setTimeout(function() {
  mypie.setOptions({data:[0.1], maxValues:3, labelMaxSize: 50,showLabels:true})
}, 2000)

setTimeout(function() {
  mypie.setOptions({data:[3]})
}, 4000)

setTimeout(function() {
  mypie.setOptions({data:[3, 1, 2], labelText:["a", "b","c"]})
}, 6000)*/

    </script>
  </body>
</html>
